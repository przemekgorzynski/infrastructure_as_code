parameters:
  - name: TargetSubscriptionID
    type: string
  - name: ServicePrincipalID
    type: string
  - name: ServicePrincipalKey
    type: string
  - name: Tenant
    type: string


steps:
  - task: Bash@3
    displayName: Terraform plan
    inputs:
      targetType: 'inline'
      script: |
        export ARM_CLIENT_ID=${{ parameters.ServicePrincipalID }}
        export ARM_CLIENT_SECRET=${{ parameters.ServicePrincipalKey }}
        export ARM_TENANT_ID=${{ parameters.Tenant }}
        export ARM_SUBSCRIPTION_ID=${{ parameters.TargetSubscriptionID }}
        env | sort
        terraform plan